<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æå‡è‡ªæˆ‘ - æ¯æ—¥å­¦ä¹ æ‰“å¡</title>
    <!-- æ·»åŠ  Supabase åº“ -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        /* å…¨å±€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft Yahei', 'PingFang SC', sans-serif;
        }

        /* è‡ªå®šä¹‰æ¨±èŠ±é¼ æ ‡æŒ‡é’ˆ */
        body {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path fill="%23ff99cc" d="M10,2 C7,2 4,4 4,7 C4,10 7,13 10,16 C13,13 16,10 16,7 C16,4 13,2 10,2 Z M10,4 C12,4 14,6 14,7 C14,8 12,10 10,12 C8,10 6,8 6,7 C6,6 8,4 10,4 Z"/></svg>'), auto;
            background: #f9f7f5;
            overflow-x: hidden;
            position: relative;
            padding-right: 320px; /* ä¸ºæ’è¡Œæ¦œé¢„ç•™ç©ºé—´ */
        }

        /* ç™»å½•é¢æ¿æ ·å¼ */
        #loginPanel {
            display: flex; 
            position: fixed; 
            top:0; 
            left:0; 
            width:100%; 
            height:100%; 
            background: rgba(255,255,255,0.98); 
            z-index: 100000; 
            justify-content: center; 
            align-items: center; 
            backdrop-filter: blur(10px);
            flex-direction: column;
        }

        .login-box {
            background: white; 
            padding: 40px; 
            border-radius: 20px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
            text-align: center; 
            max-width: 400px; 
            width: 90%;
            border: 1px solid rgba(255, 102, 153, 0.1);
        }

        .login-title {
            color: #ff6699; 
            margin-bottom: 10px; 
            font-size: 24px;
        }

        .login-subtitle {
            color: #8a7d74; 
            margin-bottom: 30px; 
            font-size: 14px;
        }

        .login-select, .login-input {
            width: 100%; 
            padding: 15px; 
            margin-bottom: 20px; 
            border: 2px solid #f0ebe6; 
            border-radius: 12px; 
            font-size: 16px; 
            background: white; 
            color: #5a5652;
            transition: border-color 0.3s ease;
        }

        .login-select:focus, .login-input:focus {
            outline: none;
            border-color: #ff99cc;
            box-shadow: 0 0 0 3px rgba(255, 153, 204, 0.1);
        }

        .login-message {
            margin-top: 15px; 
            color: #ff6666; 
            font-size: 14px; 
            min-height: 20px;
            transition: all 0.3s ease;
        }

        .login-success {
            color: #66cc99 !important;
        }

        .login-tip {
            margin-top: 25px; 
            color: #8a7d74; 
            font-size: 12px; 
            line-height: 1.6;
            padding: 15px;
            background: rgba(255, 245, 240, 0.5);
            border-radius: 8px;
        }

        /* èŠ±ç“£/æ˜Ÿæ˜Ÿç‰¹æ•ˆå®¹å™¨ */
        #particle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 99999;
        }

        /* æ’è¡Œæ¦œé¢æ¿ */
        .ranking-panel {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(220, 210, 200, 0.2);
            padding: 20px;
            z-index: 9997;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        .ranking-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0ebe6;
        }

        .ranking-title {
            font-size: 18px;
            font-weight: 600;
            color: #5a5652;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ranking-title i {
            color: #ff6699;
            font-size: 20px;
        }

        .user-id {
            font-size: 14px;
            color: #ff6699;
            background: rgba(255, 240, 245, 0.5);
            padding: 4px 10px;
            border-radius: 15px;
        }

        .ranking-list {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 5px;
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        .ranking-list::-webkit-scrollbar {
            width: 6px;
        }

        .ranking-list::-webkit-scrollbar-track {
            background: #f0ebe6;
            border-radius: 3px;
        }

        .ranking-list::-webkit-scrollbar-thumb {
            background: #ffcccc;
            border-radius: 3px;
        }

        .ranking-list::-webkit-scrollbar-thumb:hover {
            background: #ff99cc;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 10px 8px;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
        }

        .ranking-item:hover {
            background: rgba(255, 245, 240, 0.5);
            transform: translateX(3px);
        }

        .rank-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #ff6699;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            margin-right: 10px;
        }

        /* å‰ä¸‰åç‰¹æ®Šæ ·å¼ */
        .rank-number.top1 {
            background: #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .rank-number.top2 {
            background: #c0c0c0;
            box-shadow: 0 0 10px rgba(192, 192, 192, 0.3);
        }

        .rank-number.top3 {
            background: #cd7f32;
            box-shadow: 0 0 10px rgba(205, 127, 50, 0.3);
        }

        .rank-info {
            flex: 1;
        }

        .rank-name {
            font-size: 15px;
            color: #5a5652;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .rank-stats {
            display: flex;
            font-size: 12px;
            color: #8a7d74;
            gap: 15px;
        }

        .rank-days {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .rank-sentences {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        /* ç§¯åˆ†æ˜¾ç¤º */
        .rank-points {
            display: flex;
            align-items: center;
            gap: 3px;
            color: #ff9900;
            font-weight: 600;
        }

        /* æ‚¬æµ®å­¦ä¹ é¢æ¿ - ç¾åŒ–ç‰ˆ */
        .floating-panel {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 360px);
            max-width: 1200px;
            min-height: 120px;
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(220, 210, 200, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path fill="%23ff6699" d="M10,2 C7,2 4,4 4,7 C4,10 7,13 10,16 C13,13 16,10 16,7 C16,4 13,2 10,2 Z M10,4 C12,4 14,6 14,7 C14,8 12,10 10,12 C8,10 6,8 6,7 C6,6 8,4 10,4 Z"/></svg>'), auto;
            user-select: none;
            z-index: 9999;
            transition: all 0.3s ease;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            padding: 15px 20px;
        }

        .floating-panel:hover {
            box-shadow: 0 12px 40px rgba(220, 210, 200, 0.3);
            transform: translateX(-50%) translateY(-5px);
        }

        .sentence-english {
            font-size: 20px;
            font-weight: 500;
            color: #5a5652;
            text-align: center;
            padding: 5px 20px;
            line-height: 1.6;
            max-width: 1100px;
            transition: color 0.3s ease;
        }

        .floating-panel:hover .sentence-english {
            color: #ff6699;
        }

        .sentence-chinese {
            font-size: 16px;
            color: #8a7d74;
            text-align: center;
            padding: 5px 20px;
            line-height: 1.5;
            max-width: 1100px;
            margin-top: 8px;
        }

        /* å¯ç‚¹å‡»å•è¯æ ·å¼ */
        .word-span {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path fill="%23ff99cc" d="M10,2 C7,2 4,4 4,7 C4,10 7,13 10,16 C13,13 16,10 16,7 C16,4 13,2 10,2 Z M10,4 C12,4 14,6 14,7 C14,8 12,10 10,12 C8,10 6,8 6,7 C6,6 8,4 10,4 Z"/></svg>'), pointer;
            position: relative;
            padding: 0 2px;
            border-bottom: 1px dashed #ffcccc;
        }

        .word-span:hover {
            color: #ff6699;
            background-color: rgba(255, 240, 245, 0.5);
            border-radius: 2px;
        }

        /* å¼•å¯¼æç¤ºæ  */
        .guide-bar {
            position: absolute;
            top: 200px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 30px;
            background: rgba(255, 245, 240, 0.8);
            border-radius: 30px;
            color: #8a7d74;
            font-size: 14px;
            box-shadow: 0 4px 16px rgba(220, 210, 200, 0.15);
            z-index: 9998;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            transition: all 0.3s ease;
        }

        .guide-bar:hover {
            background: rgba(255, 245, 240, 1);
            transform: translateX(-50%) translateY(-3px);
        }

        /* æ¯æ—¥ä»»åŠ¡é¢æ¿ */
        .task-panel {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 360px);
            max-width: 800px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(220, 210, 200, 0.2);
            padding: 20px;
            z-index: 9998;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0ebe6;
        }

        .task-title {
            font-size: 18px;
            font-weight: 600;
            color: #5a5652;
        }

        .task-stats {
            font-size: 14px;
            color: #ff6699;
        }

        .task-progress {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: #f0ebe6;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6699, #ff99cc);
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            font-size: 14px;
            color: #8a7d74;
            min-width: 60px;
            text-align: right;
        }

        .task-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .btn {
            padding: 10px 25px;
            border: none;
            border-radius: 30px;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path fill="%23ffffff" d="M10,2 C7,2 4,4 4,7 C4,10 7,13 10,16 C13,13 16,10 16,7 C16,4 13,2 10,2 Z M10,4 C12,4 14,6 14,7 C14,8 12,10 10,12 C8,10 6,8 6,7 C6,6 8,4 10,4 Z"/></svg>'), auto;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(255, 102, 153, 0.2);
        }

        .btn-primary {
            background: linear-gradient(90deg, #ff6699, #ff99cc);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(255, 102, 153, 0.3);
        }

        .btn-secondary {
            background: #f0ebe6;
            color: #8a7d74;
        }

        .btn-secondary:hover {
            background: #e6dfd9;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(220, 210, 200, 0.2);
        }

        /* ç§¯åˆ†æŒ‰é’® */
        .btn-points {
            background: linear-gradient(90deg, #ff9900, #ffcc00);
            color: white;
        }

        .btn-points:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(255, 153, 0, 0.3);
        }

        /* é»˜å†™å¼¹çª— - ç¾åŒ–ç‰ˆ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(90, 86, 82, 0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 12px 40px rgba(90, 86, 82, 0.2);
            position: relative;
            animation: modalPop 0.4s ease;
        }

        @keyframes modalPop {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-title {
            font-size: 20px;
            margin-bottom: 20px;
            color: #5a5652;
            text-align: center;
            font-weight: 600;
        }

        .input-area {
            width: 100%;
            height: 100px;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #f0ebe6;
            border-radius: 12px;
            margin-bottom: 20px;
            resize: none;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        .input-area:focus {
            outline: none;
            border-color: #ff99cc;
            box-shadow: 0 0 0 4px rgba(255, 153, 204, 0.1);
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        /* æ˜¾ç¤ºä¸­æ–‡æŒ‰é’® */
        .btn-chinese {
            background: linear-gradient(90deg, #66cc99, #99ffcc);
            color: white;
            margin-bottom: 10px;
        }

        .btn-chinese:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(102, 204, 153, 0.3);
        }

        /* ä¸­æ–‡æç¤ºåŒºåŸŸ */
        .chinese-hint {
            display: none;
            padding: 15px;
            background: rgba(102, 204, 153, 0.1);
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #66cc99;
        }

        /* ç»“æœæç¤ºå¼¹çª— */
        .result-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px;
            border-radius: 16px;
            background: white;
            box-shadow: 0 12px 40px rgba(90, 86, 82, 0.2);
            z-index: 10001;
            max-width: 500px;
            text-align: center;
            animation: modalPop 0.4s ease;
            display: none;
        }

        .result-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .result-correct {
            color: #66cc99;
        }

        .result-error {
            color: #ff6666;
        }

        .result-text {
            font-size: 16px;
            line-height: 1.8;
            color: #5a5652;
            white-space: pre-wrap;
            margin-bottom: 20px;
        }

        .btn-close {
            padding: 8px 20px;
            background: #f0ebe6;
            color: #5a5652;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-close:hover {
            background: #e6dfd9;
        }

        /* æ‰“å¡æˆåŠŸå¼¹çª— */
        .checkin-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 40px;
            border-radius: 20px;
            background: linear-gradient(135deg, #ff6699, #ff99cc);
            color: white;
            box-shadow: 0 15px 40px rgba(255, 102, 153, 0.3);
            z-index: 10001;
            max-width: 500px;
            text-align: center;
            animation: checkinPop 0.6s ease;
            display: none;
        }

        @keyframes checkinPop {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.05);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .checkin-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .checkin-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .checkin-text {
            font-size: 18px;
            margin-bottom: 25px;
            opacity: 0.9;
        }

        /* å•è¯é‡Šä¹‰å¼¹çª— */
        .word-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(90, 86, 82, 0.3);
            z-index: 10002;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(2px);
        }

        .word-modal-content {
            background: white;
            padding: 25px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 8px 24px rgba(255, 102, 153, 0.2);
            position: relative;
            animation: modalPop 0.3s ease;
        }

        .word-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0ebe6;
        }

        .word-name {
            font-size: 20px;
            font-weight: 600;
            color: #ff6699;
        }

        .word-close {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #f0ebe6;
            border: none;
            color: #8a7d74;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .word-close:hover {
            background: #ff6699;
            color: white;
        }

        .word-pronunciation {
            color: #8a7d74;
            font-size: 14px;
            margin-bottom: 10px;
            font-style: italic;
        }

        .word-meaning {
            color: #5a5652;
            font-size: 15px;
            line-height: 1.8;
        }

        .word-example {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #f0ebe6;
            color: #8a7d74;
            font-size: 14px;
            font-style: italic;
        }

        /* ç§¯åˆ†è¯´æ˜å¼¹çª— */
        .points-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(90, 86, 82, 0.5);
            z-index: 10003;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(4px);
        }

        .points-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 12px 40px rgba(90, 86, 82, 0.2);
            position: relative;
            animation: modalPop 0.4s ease;
            max-height: 80vh;
            overflow-y: auto;
        }

        .points-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: #ff9900;
            text-align: center;
            font-weight: 600;
        }

        .points-list {
            margin-bottom: 25px;
        }

        .point-item {
            padding: 12px 15px;
            margin-bottom: 10px;
            background: rgba(255, 245, 240, 0.5);
            border-radius: 8px;
            border-left: 4px solid #ff9900;
        }

        .point-points {
            font-weight: 600;
            color: #ff9900;
            margin-right: 10px;
        }

        .point-reward {
            color: #5a5652;
        }

        .point-special {
            background: rgba(255, 240, 245, 0.8);
            border-left-color: #ff6699;
            font-weight: 600;
        }

        /* å“åº”å¼é€‚é… */
        @media (max-width: 1200px) {
            body {
                padding-right: 0;
            }
            .ranking-panel {
                position: fixed;
                top: auto;
                bottom: 120px;
                left: 50%;
                transform: translateX(-50%);
                width: 80%;
                max-width: 800px;
                height: 200px;
            }
            .ranking-list {
                max-height: 120px;
            }
            .floating-panel {
                width: 80%;
                max-width: 1200px;
            }
            .task-panel {
                width: 80%;
                max-width: 800px;
                bottom: 320px;
            }
        }

        @media (max-width: 768px) {
            .floating-panel {
                min-height: 100px;
                top: 30px;
                width: 95%;
            }
            .sentence-english {
                font-size: 16px;
            }
            .sentence-chinese {
                font-size: 14px;
            }
            .guide-bar {
                top: 180px;
                padding: 10px 20px;
                font-size: 12px;
                width: 90%;
                text-align: center;
            }
            .task-panel {
                width: 95%;
                bottom: 300px;
                padding: 15px;
            }
            .ranking-panel {
                width: 95%;
                bottom: 100px;
            }
            .modal-content {
                padding: 20px;
            }
            .btn-group {
                flex-wrap: wrap;
            }
            .login-box {
                padding: 25px 20px;
                margin: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•é¢æ¿ (å¿…é¡»æ”¾åœ¨æœ€å‰é¢) -->
    <div id="loginPanel">
        <div class="login-box">
            <h2 class="login-title">ğŸ¯ è‹±è¯­å­¦ä¹ æ‰“å¡</h2>
            <p class="login-subtitle">è¯·ä»ä»¥ä¸‹åå•ä¸­é€‰æ‹©æ‚¨çš„æ˜µç§°å¹¶è®¾ç½®å¯†ç </p>
            
            <select id="usernameSelect" class="login-select">
                <option value="">è¯·é€‰æ‹©æ˜µç§°...</option>
                <option value="æ˜Šæ˜Š">æ˜Šæ˜Š</option>
                <option value="æœ‹æœ‹">æœ‹æœ‹</option>
                <option value="å…šå…š">å…šå…š</option>
                <option value="é‡‘é‡‘">é‡‘é‡‘</option>
                <option value="æ·¼æ·¼">æ·¼æ·¼</option>
                <option value="æ–‡æ–‡">æ–‡æ–‡</option>
                <option value="é™é™">é™é™</option>
                <option value="ç‘¶ç‘¶">ç‘¶ç‘¶</option>
                <option value="æ°æ°">æ°æ°</option>
                <option value="æ¥ æ¥ ">æ¥ æ¥ </option>
                <option value="èŒèŒ">èŒèŒ</option>
                <option value="å§œå§œ">å§œå§œ</option>
                <option value="çœŸçœŸ">çœŸçœŸ</option>
                <option value="ä¸œä¸œ">ä¸œä¸œ</option>
                <option value="ç¾Šç¾Š">ç¾Šç¾Š</option>
            </select>
            
            <input type="password" id="passwordInput" class="login-input" placeholder="è¯·è®¾ç½®/è¾“å…¥æ‚¨çš„å¯†ç  (è‡³å°‘3ä½)">
            
            <button id="loginBtn" class="btn btn-primary" style="width: 100%; padding: 15px;">ç™»å½• / æ³¨å†Œ</button>
            
            <p id="loginMessage" class="login-message"></p>
            
            <div class="login-tip">
                ğŸ’¡ <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
                1. é¦–æ¬¡é€‰æ‹©æ˜µç§°å¹¶è¾“å…¥å¯†ç å³ä¸ºæ³¨å†Œ<br>
                2. ä¹‹åä½¿ç”¨ç›¸åŒæ˜µç§°å’Œå¯†ç ç™»å½•<br>
                3. ç§¯åˆ†æ°¸ä¹…ä¿å­˜åœ¨äº‘ç«¯ï¼Œå¯åœ¨ä»»ä½•è®¾å¤‡æŸ¥çœ‹<br>
                4. æ¯äººåªèƒ½é€‰æ‹©ä¸€ä¸ªæ˜µç§°ï¼Œè¯·å‹¿é‡å¤
            </div>
        </div>
    </div>

    <!-- ç²’å­ç‰¹æ•ˆå®¹å™¨ -->
    <div id="particle-container"></div>

    <!-- æ’è¡Œæ¦œé¢æ¿ -->
    <div class="ranking-panel">
        <div class="ranking-header">
            <div class="ranking-title">
                <i>ğŸ†</i> ç§¯åˆ†æ’è¡Œæ¦œ
            </div>
            <div class="user-id" id="currentUserId">è¯·å…ˆç™»å½•...</div>
        </div>
        <div class="ranking-list" id="rankingList">
            <!-- æ’è¡Œæ¦œå†…å®¹åŠ¨æ€ç”Ÿæˆ -->
            <div style="text-align: center; padding: 40px 20px; color: #8a7d74;">
                <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“Š</div>
                <div>ç™»å½•åæŸ¥çœ‹å®æ—¶æ’è¡Œæ¦œ</div>
            </div>
        </div>
        <div style="text-align: center; margin-top: 10px;">
            <button class="btn btn-points" onclick="showPointsModal()" style="padding: 8px 15px; font-size: 13px;">ğŸ“‹ ç§¯åˆ†å…‘æ¢è¯´æ˜</button>
        </div>
    </div>

    <!-- æ‚¬æµ®å­¦ä¹ é¢æ¿ -->
    <div class="floating-panel" id="floatingPanel">
        <div class="sentence-english" id="sentenceEnglish">âœ¨ è¯·å…ˆç™»å½•å¼€å§‹å­¦ä¹ </div>
        <div class="sentence-chinese" id="sentenceChinese">ç™»å½•åå¯ä»¥æŸ¥çœ‹å¥å­å¹¶å¼€å§‹é»˜å†™</div>
    </div>

    <!-- å¼•å¯¼æç¤º -->
    <div class="guide-bar" id="guideBar">
        ğŸ“– è¯·å…ˆç™»å½•ï¼Œç„¶åç‚¹å‡»å•è¯å¯æŸ¥çœ‹é‡Šä¹‰ï¼Œç†Ÿè¯»åç‚¹å‡»ã€Œå¼€å§‹é»˜å†™ã€å®Œæˆæ¯æ—¥5å¥å­¦ä¹ ä»»åŠ¡ï¼
    </div>

    <!-- æ¯æ—¥ä»»åŠ¡é¢æ¿ -->
    <div class="task-panel">
        <div class="task-header">
            <div class="task-title">æ¯æ—¥å­¦ä¹ ä»»åŠ¡</div>
            <div class="task-stats" id="taskStats">è¯·å…ˆç™»å½• | ç§¯åˆ†: 0</div>
        </div>
        <div class="task-progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">0/5</div>
        </div>
        <div class="task-actions">
            <button class="btn btn-secondary" onclick="refreshSentence()" disabled>æ›´æ¢å¥å­</button>
            <button class="btn btn-primary" onclick="triggerModalNow()" disabled>å¼€å§‹é»˜å†™</button>
            <button class="btn btn-points" onclick="showPointsModal()">ç§¯åˆ†è¯´æ˜</button>
        </div>
    </div>

    <!-- é»˜å†™å¼¹çª— -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-title">âœï¸ è¯·é»˜å†™å½“å‰å­¦ä¹ çš„å¥å­</div>
            <div class="chinese-hint" id="chineseHint"></div>
            <button class="btn btn-chinese" onclick="toggleChineseHint()">æ˜¾ç¤ºä¸­æ–‡æç¤º</button>
            <textarea class="input-area" id="inputArea" placeholder="è¯·è¾“å…¥ä½ è®°å¿†çš„å¥å­..."></textarea>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="checkAnswer()">æäº¤æ ¡å¯¹</button>
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- ç»“æœæç¤ºæ¡† -->
    <div class="result-alert" id="resultAlert">
        <div class="result-title" id="resultTitle"></div>
        <div class="result-text" id="resultContent"></div>
        <button class="btn-close" onclick="closeResultAlert()">ç¡®å®š</button>
    </div>

    <!-- æ‰“å¡æˆåŠŸå¼¹çª— -->
    <div class="checkin-alert" id="checkinAlert">
        <div class="checkin-icon">ğŸ‰</div>
        <div class="checkin-title">æ­å–œå®Œæˆä»Šæ—¥æ‰“å¡ï¼</div>
        <div class="checkin-text" id="checkinText">ä½ å·²åšæŒå­¦ä¹  0 å¤©ï¼Œç»§ç»­åŠ æ²¹ï¼</div>
        <button class="btn-close" style="background: white; color: #ff6699;" onclick="closeCheckinAlert()">å¤ªæ£’äº†ï¼</button>
    </div>

    <!-- å•è¯é‡Šä¹‰å¼¹çª— -->
    <div class="word-modal" id="wordModal">
        <div class="word-modal-content">
            <div class="word-header">
                <div class="word-name" id="wordName"></div>
                <button class="word-close" onclick="closeWordModal()">Ã—</button>
            </div>
            <div class="word-pronunciation" id="wordPronunciation"></div>
            <div class="word-meaning" id="wordMeaning"></div>
            <div class="word-example" id="wordExample"></div>
        </div>
    </div>

    <!-- ç§¯åˆ†è¯´æ˜å¼¹çª— -->
    <div class="points-modal" id="pointsModal">
        <div class="points-content">
            <div class="points-title">ğŸ ç§¯åˆ†å…‘æ¢è¯´æ˜</div>
            <div class="points-list">
                <div class="point-item">
                    <span class="point-points">10 ç§¯åˆ†</span>
                    <span class="point-reward">å¯å…‘æ¢æ©™å­ä¸€ä¸ª ğŸŠ</span>
                </div>
                <div class="point-item">
                    <span class="point-points">20 ç§¯åˆ†</span>
                    <span class="point-reward">å¯å…‘æ¢è‹¹æœä¸€ä¸ª ğŸ</span>
                </div>
                <div class="point-item">
                    <span class="point-points">30 ç§¯åˆ†</span>
                    <span class="point-reward">å¯å…‘æ¢æ¢¨å­ä¸€ä¸ª ğŸ</span>
                </div>
                <div class="point-item">
                    <span class="point-points">50 ç§¯åˆ†</span>
                    <span class="point-reward">å¯å…‘æ¢å¹²è„†é¢åŒ…ä¸ä¸€åŒ… ğŸ</span>
                </div>
                <div class="point-item point-special">
                    <span class="point-points">10000 ç§¯åˆ†</span>
                    <span class="point-reward">å¯è·å¾—é¦™å»ä¸€ä¸ª ğŸ’‹ (ä»…é™ID: 5201314)</span>
                </div>
            </div>
            <div style="color: #8a7d74; font-size: 14px; line-height: 1.6; margin-bottom: 20px;">
                <p>ğŸ’¡ <strong>ç§¯åˆ†è·å–è§„åˆ™ï¼š</strong></p>
                <p>1. æ¯æ­£ç¡®é»˜å†™ä¸€ä¸ªå¥å­ +1 ç§¯åˆ†</p>
                <p>2. æ¯æ—¥å®Œæˆ5å¥ä»»åŠ¡ +5 ç§¯åˆ†</p>
                <p>3. è¿ç»­æ‰“å¡7å¤©é¢å¤– +10 ç§¯åˆ†</p>
                <p>4. ç§¯åˆ†æ°¸ä¹…æœ‰æ•ˆï¼Œä¸æ¸…é›¶</p>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="closePointsModal()">æˆ‘çŸ¥é“äº†</button>
            </div>
        </div>
    </div>

    <script>
        // ========== Supabase é…ç½® ==========
        // è¯·ç¡®ä¿å·²æ›¿æ¢ä¸ºæ‚¨çš„çœŸå® Supabase ä¿¡æ¯
        const SUPABASE_URL = 'https://qwjluoxicuhqrneysoqv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF3amx1b3hpY3VocXJuZXlzb3F2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMTQyNjIsImV4cCI6MjA4MTY5MDI2Mn0.UrX6Dhvvd5dtbAolnpAKpNetCPiIEQOpp5CYrvRlfxA';
        
        // åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // ========== å…¨å±€å˜é‡ ==========
        let currentUser = null;
        let currentSentence = "";
        let currentSentenceChinese = "";
        let dragPanel = null;
        let dragStartX = 0;
        let dragStartY = 0;
        let currentModalSentence = "";
        let currentModalChinese = "";
        
        // æ¯æ—¥ä»»åŠ¡æ•°æ®
        let dailyTaskCount = 0;
        const dailyTaskTarget = 5;
        let persistDays = 0;
        let lastCheckinDate = "";
        let userPoints = 0;
        
        // ç”¨æˆ·ååˆ—è¡¨ï¼ˆå¿…é¡»åœ¨åå•ä¸­é€‰æ‹©ï¼‰
        const allowedUsernames = ["æ˜Šæ˜Š", "æœ‹æœ‹", "å…šå…š", "é‡‘é‡‘", "æ·¼æ·¼", "æ–‡æ–‡", "é™é™", "ç‘¶ç‘¶", "æ°æ°", "æ¥ æ¥ ", "èŒèŒ", "å§œå§œ", "çœŸçœŸ", "ä¸œä¸œ", "ç¾Šç¾Š"];

        // ========== åˆå§‹åŒ–å‡½æ•° ==========
        window.onload = async function() {
            // ç»‘å®šç™»å½•æŒ‰é’®äº‹ä»¶
            document.getElementById('loginBtn').addEventListener('click', handleLogin);
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ç°æœ‰ä¼šè¯
            const { data: { session } } = await supabase.auth.getSession();
            
            if (session?.user) {
                // å·²ç™»å½•ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯
                await fetchUserProfile(session.user.id);
            } else {
                // æœªç™»å½•ï¼Œç¡®ä¿ç™»å½•é¢æ¿æ˜¾ç¤º
                document.getElementById('loginPanel').style.display = 'flex';
                disableLearningFeatures();
            }
            
            // åˆå§‹åŒ–ç²’å­ç‰¹æ•ˆ
            initParticleEffect();
            
            // ç»‘å®šæ–‡æœ¬æ¡†å›è½¦äº‹ä»¶
            document.getElementById('inputArea').addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    checkAnswer();
                }
            });
            
            // ç»‘å®šå¯†ç æ¡†å›è½¦äº‹ä»¶
            document.getElementById('passwordInput').addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    handleLogin();
                }
            });
        };

        // ========== ç™»å½•/æ³¨å†Œå¤„ç† ==========
        async function handleLogin() {
            const username = document.getElementById('usernameSelect').value;
            const password = document.getElementById('passwordInput').value;
            const messageEl = document.getElementById('loginMessage');
            
            // éªŒè¯è¾“å…¥
            if (!username) {
                messageEl.textContent = 'è¯·ä»åå•ä¸­é€‰æ‹©ä¸€ä¸ªæ˜µç§°ï¼';
                messageEl.className = 'login-message';
                return;
            }
            
            if (!password || password.length < 3) {
                messageEl.textContent = 'å¯†ç è‡³å°‘éœ€è¦3ä¸ªå­—ç¬¦ï¼';
                messageEl.className = 'login-message';
                return;
            }
            
            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦åœ¨å…è®¸çš„åå•ä¸­
            if (!allowedUsernames.includes(username)) {
                messageEl.textContent = 'æ˜µç§°ä¸åœ¨å…è®¸çš„åå•ä¸­ï¼';
                messageEl.className = 'login-message';
                return;
            }
            
            messageEl.textContent = 'å¤„ç†ä¸­...';
            messageEl.className = 'login-message';
            
            try {
                // ä½¿ç”¨"ç”¨æˆ·å@englishlearner.com"ä½œä¸ºé‚®ç®±
                const email = `${username}@englishlearner.com`;
                
                // å°è¯•ç™»å½•
                const { data: loginData, error: loginError } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (loginError) {
                    // å¦‚æœæ˜¯å‡­è¯é”™è¯¯ï¼Œå°è¯•æ³¨å†Œ
                    if (loginError.message.includes('Invalid login credentials')) {
                        const { data: signUpData, error: signUpError } = await supabase.auth.signUp({
                            email: email,
                            password: password,
                            options: {
                                data: {
                                    username: username,
                                    points: 0,
                                    days: 0,
                                    sentences: 0,
                                    created_at: new Date().toISOString()
                                }
                            }
                        });
                        
                        if (signUpError) {
                            if (signUpError.message.includes('User already registered')) {
                                messageEl.textContent = 'è¯¥æ˜µç§°å·²è¢«æ³¨å†Œï¼Œè¯·ä½¿ç”¨å¯†ç ç™»å½•æˆ–é€‰æ‹©å…¶ä»–æ˜µç§°ï¼';
                            } else {
                                throw signUpError;
                            }
                            return;
                        }
                        
                        // æ³¨å†ŒæˆåŠŸ
                        await fetchUserProfile(signUpData.user.id);
                        messageEl.textContent = 'æ³¨å†ŒæˆåŠŸï¼æ­£åœ¨è¿›å…¥å­¦ä¹ ...';
                        messageEl.className = 'login-message login-success';
                    } else {
                        throw loginError;
                    }
                } else {
                    // ç™»å½•æˆåŠŸ
                    await fetchUserProfile(loginData.user.id);
                    messageEl.textContent = 'ç™»å½•æˆåŠŸï¼æ­£åœ¨è¿›å…¥å­¦ä¹ ...';
                    messageEl.className = 'login-message login-success';
                }
                
                // å»¶è¿Ÿ1ç§’åè¿›å…¥å­¦ä¹ ç•Œé¢
                setTimeout(() => {
                    document.getElementById('loginPanel').style.display = 'none';
                    enableLearningFeatures();
                    refreshSentence();
                    initDrag();
                    updateTaskProgress();
                    fetchAllUsersRanking();
                }, 1000);
                
            } catch (error) {
                console.error('ç™»å½•/æ³¨å†Œé”™è¯¯:', error);
                messageEl.textContent = 'æ“ä½œå¤±è´¥ï¼š' + (error.message || 'æœªçŸ¥é”™è¯¯');
                messageEl.className = 'login-message';
            }
        }

        // ========== ç”¨æˆ·èµ„æ–™ç®¡ç† ==========
        async function fetchUserProfile(userId) {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                
                if (user) {
                    currentUser = {
                        id: user.id,
                        username: user.user_metadata?.username || 'æœªçŸ¥ç”¨æˆ·',
                        points: user.user_metadata?.points || 0,
                        days: user.user_metadata?.days || 0,
                        sentences: user.user_metadata?.sentences || 0
                    };
                    
                    userPoints = currentUser.points;
                    persistDays = currentUser.days;
                    
                    // ä»æœ¬åœ°å­˜å‚¨æ¢å¤ä»Šæ—¥ä»»åŠ¡æ•°
                    const today = new Date().toLocaleDateString();
                    const storedDate = localStorage.getItem('lastCheckinDate');
                    if (storedDate === today) {
                        dailyTaskCount = localStorage.getItem('dailyTaskCount') ? parseInt(localStorage.getItem('dailyTaskCount')) : 0;
                    } else {
                        dailyTaskCount = 0;
                    }
                    
                    updateTaskStats();
                    document.getElementById('currentUserId').textContent = `ä½ ï¼š${currentUser.username} (ç§¯åˆ†: ${userPoints})`;
                }
            } catch (error) {
                console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
            }
        }

        async function updateUserProfile() {
            if (!currentUser) return;
            
            try {
                const { error } = await supabase.auth.updateUser({
                    data: { 
                        points: userPoints,
                        days: persistDays,
                        sentences: persistDays * 5 + dailyTaskCount,
                        last_updated: new Date().toISOString()
                    }
                });
                
                if (error) throw error;
                
                // æ›´æ–°æœ¬åœ°currentUserå¯¹è±¡
                currentUser.points = userPoints;
                currentUser.days = persistDays;
                currentUser.sentences = persistDays * 5 + dailyTaskCount;
                
            } catch (error) {
                console.error('æ›´æ–°ç”¨æˆ·èµ„æ–™å¤±è´¥:', error);
            }
        }

        // ========== ç§¯åˆ†ç®¡ç† ==========
        async function addUserPoints(pointsToAdd) {
            if (!currentUser) return;
            
            userPoints += pointsToAdd;
            
            // ä¿å­˜ä»Šæ—¥ä»»åŠ¡æ•°åˆ°æœ¬åœ°å­˜å‚¨
            const today = new Date().toLocaleDateString();
            localStorage.setItem('dailyTaskCount', dailyTaskCount);
            localStorage.setItem('lastCheckinDate', today);
            
            // æ›´æ–°ç”¨æˆ·èµ„æ–™ï¼ˆäº‘ç«¯ï¼‰
            await updateUserProfile();
            
            // æ›´æ–°ç•Œé¢
            updateTaskStats();
            document.getElementById('currentUserId').textContent = `ä½ ï¼š${currentUser.username} (ç§¯åˆ†: ${userPoints})`;
            
            // æ›´æ–°æ’è¡Œæ¦œ
            await fetchAllUsersRanking();
        }

        // ========== æ’è¡Œæ¦œç®¡ç† ==========
        async function fetchAllUsersRanking() {
            try {
                // åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œåº”è¯¥æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
                // ç”±äºSupabase Authè¡¨ä¸èƒ½ç›´æ¥æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®+å½“å‰ç”¨æˆ·
                
                // æ¨¡æ‹Ÿä¸€äº›ç”¨æˆ·æ•°æ®
                const mockUsers = [
                    { username: "æ˜Šæ˜Š", points: 156, days: 31, sentences: 155 },
                    { username: "æœ‹æœ‹", points: 142, days: 28, sentences: 142 },
                    { username: "æ–‡æ–‡", points: 128, days: 25, sentences: 128 },
                    { username: "é™é™", points: 115, days: 23, sentences: 115 },
                    { username: "ç‘¶ç‘¶", points: 98, days: 19, sentences: 98 },
                    { username: "æ°æ°", points: 87, days: 17, sentences: 87 },
                    { username: "æ¥ æ¥ ", points: 76, days: 15, sentences: 76 },
                    { username: "ç¾Šç¾Š", points: 65, days: 13, sentences: 65 }
                ];
                
                // æ·»åŠ å½“å‰ç”¨æˆ·
                const allUsers = [...mockUsers];
                if (currentUser) {
                    allUsers.push({
                        username: currentUser.username,
                        points: currentUser.points,
                        days: currentUser.days,
                        sentences: currentUser.days * 5 + dailyTaskCount
                    });
                }
                
                // æŒ‰ç§¯åˆ†æ’åº
                allUsers.sort((a, b) => b.points - a.points);
                
                // æ¸²æŸ“æ’è¡Œæ¦œ
                renderRankingList(allUsers);
                
            } catch (error) {
                console.error('è·å–æ’è¡Œæ¦œæ•°æ®å¤±è´¥:', error);
            }
        }

        function renderRankingList(users) {
            const rankingList = document.getElementById('rankingList');
            
            if (!users || users.length === 0) {
                rankingList.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #8a7d74;">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“Š</div>
                        <div>æš‚æ— æ’è¡Œæ¦œæ•°æ®</div>
                    </div>
                `;
                return;
            }
            
            rankingList.innerHTML = '';
            
            users.forEach((user, index) => {
                const rankItem = document.createElement('div');
                rankItem.className = 'ranking-item';
                
                // ä¸ºå‰ä¸‰åæ·»åŠ ç‰¹æ®Šæ ·å¼
                let rankClass = '';
                if (index === 0) rankClass = 'top1';
                else if (index === 1) rankClass = 'top2';
                else if (index === 2) rankClass = 'top3';
                
                // çªå‡ºæ˜¾ç¤ºå½“å‰ç”¨æˆ·
                const isCurrentUser = currentUser && user.username === currentUser.username;
                if (isCurrentUser) {
                    rankItem.style.background = 'rgba(255, 240, 245, 0.8)';
                    rankItem.style.border = '1px solid #ffcccc';
                }
                
                rankItem.innerHTML = `
                    <div class="rank-number ${rankClass}">${index + 1}</div>
                    <div class="rank-info">
                        <div class="rank-name">${user.username} ${isCurrentUser ? 'ğŸ‘¤' : ''}</div>
                        <div class="rank-stats">
                            <div class="rank-days">
                                <span>ğŸ“…</span> ${user.days}å¤©
                            </div>
                            <div class="rank-sentences">
                                <span>ğŸ“–</span> ${user.sentences}å¥
                            </div>
                            <div class="rank-points">
                                <span>â­</span> ${user.points}åˆ†
                            </div>
                        </div>
                    </div>
                `;
                
                rankingList.appendChild(rankItem);
            });
        }

        // ========== å­¦ä¹ åŠŸèƒ½ç®¡ç† ==========
        function disableLearningFeatures() {
            document.querySelector('.btn-secondary').disabled = true;
            document.querySelector('.btn-primary').disabled = true;
        }

        function enableLearningFeatures() {
            document.querySelector('.btn-secondary').disabled = false;
            document.querySelector('.btn-primary').disabled = false;
        }

        // ========== å­¦ä¹ å†…å®¹åº“ï¼ˆä¿æŒä¸å˜ï¼‰==========
        const learnSentences = [
            {
                en: "The celebrated theory is still the source of great controversy.",
                cn: "è¿™ä¸ªè‘—åçš„ç†è®ºä»ç„¶æ˜¯å·¨å¤§äº‰è®®çš„æ ¹æºã€‚"
            },
            {
                en: "A group meeting will be held tomorrow in the library conference room.",
                cn: "æ˜å¤©å°†åœ¨å›¾ä¹¦é¦†ä¼šè®®å®¤ä¸¾è¡Œå°ç»„ä¼šè®®ã€‚"
            },
            {
                en: "The company's rapid expansion has led to some growing pains.",
                cn: "å…¬å¸çš„å¿«é€Ÿæ‰©å¼ å¸¦æ¥äº†ä¸€äº›æˆé•¿ä¸­çš„é˜µç—›ã€‚"
            },
            {
                en: "She proposed an innovative approach to solving the problem.",
                cn: "å¥¹æå‡ºäº†ä¸€ä¸ªåˆ›æ–°æ€§çš„è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚"
            },
            {
                en: "The research findings were published in a prestigious journal.",
                cn: "ç ”ç©¶ç»“æœå‘è¡¨åœ¨ä¸€æœ¬è‘—åçš„æœŸåˆŠä¸Šã€‚"
            },
            {
                en: "He demonstrated remarkable resilience in the face of adversity.",
                cn: "é¢å¯¹é€†å¢ƒï¼Œä»–å±•ç°äº†éå‡¡çš„éŸ§æ€§ã€‚"
            },
            {
                en: "The committee will review all applications by the end of the month.",
                cn: "å§”å‘˜ä¼šå°†åœ¨æœˆåº•å‰å®¡æŸ¥æ‰€æœ‰ç”³è¯·ã€‚"
            },
            {
                en: "Environmental protection should be a priority for every government.",
                cn: "ç¯å¢ƒä¿æŠ¤åº”è¯¥æ˜¯æ¯ä¸ªæ”¿åºœçš„ä¼˜å…ˆäº‹é¡¹ã€‚"
            },
            {
                en: "The new policy aims to promote sustainable development.",
                cn: "æ–°æ”¿ç­–æ—¨åœ¨ä¿ƒè¿›å¯æŒç»­å‘å±•ã€‚"
            },
            {
                en: "Her presentation was both informative and engaging.",
                cn: "å¥¹çš„æ¼”è®²æ—¢æœ‰ä¿¡æ¯é‡åˆæœ‰å¸å¼•åŠ›ã€‚"
            }
        ];

        const wordDictionary = {
            "celebrated": {
                pronunciation: "/ËˆselÉªbreÉªtÉªd/",
                meaning: "adj. è‘—åçš„ï¼›æœ‰åæœ›çš„ï¼›å—èµèª‰çš„",
                example: "ä¾‹å¥ï¼šShe is a celebrated pianist. (å¥¹æ˜¯ä¸€ä½è‘—åçš„é’¢ç´å®¶ã€‚)"
            },
            "theory": {
                pronunciation: "/ËˆÎ¸ÉªÉ™ri/",
                meaning: "n. ç†è®ºï¼›å­¦è¯´ï¼›åŸç†",
                example: "ä¾‹å¥ï¼šEinstein's theory of relativity changed physics. (çˆ±å› æ–¯å¦çš„ç›¸å¯¹è®ºæ”¹å˜äº†ç‰©ç†å­¦ã€‚)"
            },
            "controversy": {
                pronunciation: "/ËˆkÉ’ntrÉ™vÉœËsi/",
                meaning: "n. äº‰è®®ï¼›äº‰è®ºï¼›è¾©è®º",
                example: "ä¾‹å¥ï¼šThe new law caused much controversy. (æ–°æ³•å¾‹å¼•èµ·äº†å¾ˆå¤šäº‰è®®ã€‚)"
            },
            "expansion": {
                pronunciation: "/ÉªkËˆspÃ¦nÊƒn/",
                meaning: "n. æ‰©å¼ ï¼›æ‰©å¤§ï¼›æ‰©å±•",
                example: "ä¾‹å¥ï¼šThe company's expansion into new markets was successful. (å…¬å¸å‘æ–°å¸‚åœºçš„æ‰©å¼ å¾ˆæˆåŠŸã€‚)"
            },
            "innovative": {
                pronunciation: "/ËˆÉªnÉ™veÉªtÉªv/",
                meaning: "adj. åˆ›æ–°çš„ï¼›é©æ–°çš„",
                example: "ä¾‹å¥ï¼šThey developed an innovative solution to the problem. (ä»–ä»¬æå‡ºäº†ä¸€ä¸ªåˆ›æ–°çš„è§£å†³æ–¹æ¡ˆã€‚)"
            },
            "prestigious": {
                pronunciation: "/preËˆstÉªdÊ’É™s/",
                meaning: "adj. æœ‰å¨æœ›çš„ï¼›æœ‰å£°æœ›çš„ï¼›å—å°Šæ•¬çš„",
                example: "ä¾‹å¥ï¼šHe graduated from a prestigious university. (ä»–æ¯•ä¸šäºä¸€æ‰€åç‰Œå¤§å­¦ã€‚)"
            },
            "resilience": {
                pronunciation: "/rÉªËˆzÉªliÉ™ns/",
                meaning: "n. éŸ§æ€§ï¼›æ¢å¤åŠ›ï¼›é€‚åº”åŠ›",
                example: "ä¾‹å¥ï¼šChildren often show remarkable resilience. (å­©å­ä»¬é€šå¸¸è¡¨ç°å‡ºéå‡¡çš„éŸ§æ€§ã€‚)"
            },
            "sustainable": {
                pronunciation: "/sÉ™ËˆsteÉªnÉ™bl/",
                meaning: "adj. å¯æŒç»­çš„ï¼›èƒ½ç»´æŒçš„",
                example: "ä¾‹å¥ï¼šWe need to find sustainable energy sources. (æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯æŒç»­çš„èƒ½æºã€‚)"
            },
            "informative": {
                pronunciation: "/ÉªnËˆfÉ”ËmÉ™tÉªv/",
                meaning: "adj. æä¾›ä¿¡æ¯çš„ï¼›å¢é•¿è§é—»çš„",
                example: "ä¾‹å¥ï¼šThe documentary was very informative. (è¿™éƒ¨çºªå½•ç‰‡ä¿¡æ¯é‡å¾ˆå¤§ã€‚)"
            },
            "engaging": {
                pronunciation: "/ÉªnËˆÉ¡eÉªdÊ’ÉªÅ‹/",
                meaning: "adj. è¿·äººçš„ï¼›æœ‰å¸å¼•åŠ›çš„ï¼›æœ‰è¶£çš„",
                example: "ä¾‹å¥ï¼šHe is an engaging speaker. (ä»–æ˜¯ä¸€ä½æœ‰å¸å¼•åŠ›çš„æ¼”è®²è€…ã€‚)"
            }
        };

        // ========== åŸæœ‰å­¦ä¹ åŠŸèƒ½å‡½æ•°ï¼ˆç¨ä½œä¿®æ”¹ï¼‰==========
        function refreshSentence() {
            if (!currentUser) return;
            
            createParticle(event);
            const randomIndex = Math.floor(Math.random() * learnSentences.length);
            const sentenceItem = learnSentences[randomIndex];
            currentSentence = sentenceItem.en;
            currentSentenceChinese = sentenceItem.cn;
            
            // å¤„ç†è‹±æ–‡å¥å­
            const englishElement = document.getElementById('sentenceEnglish');
            const words = currentSentence.split(' ');
            let html = '';
            
            words.forEach(word => {
                const pureWord = word.replace(/[.,;:!?]/g, '').toLowerCase();
                if (wordDictionary[pureWord]) {
                    html += `<span class="word-span" onclick="showWordModal('${pureWord}')">${word}</span> `;
                } else {
                    html += `${word} `;
                }
            });
            
            englishElement.innerHTML = html.trim();
            document.getElementById('sentenceChinese').textContent = currentSentenceChinese;
            
            document.getElementById('guideBar').textContent = `ğŸ“– è¯·ç†Ÿè¯»å½“å‰å¥å­ï¼Œå·²å®Œæˆ ${dailyTaskCount}/${dailyTaskTarget} å¥ï¼Œå½“å‰ç§¯åˆ†: ${userPoints}`;
        }

        function initDrag() {
            const panel = document.getElementById('floatingPanel');
            panel.addEventListener('mousedown', function(e) {
                createParticle(e);
                dragPanel = panel;
                dragStartX = e.clientX - panel.offsetLeft;
                dragStartY = e.clientY - panel.offsetTop;
                e.preventDefault();
            });

            document.addEventListener('mousemove', function(e) {
                if (dragPanel) {
                    const x = e.clientX - dragStartX;
                    const y = e.clientY - dragStartY;
                    dragPanel.style.left = x + 'px';
                    dragPanel.style.top = y + 'px';
                    dragPanel.style.transform = 'none';
                }
            });

            document.addEventListener('mouseup', function() {
                dragPanel = null;
            });
        }

        function showWordModal(word) {
            if (!currentUser) return;
            
            createParticle(event);
            const wordData = wordDictionary[word];
            if (!wordData) return;
            
            document.getElementById('wordName').textContent = word;
            document.getElementById('wordPronunciation').textContent = wordData.pronunciation;
            document.getElementById('wordMeaning').textContent = wordData.meaning;
            document.getElementById('wordExample').textContent = wordData.example;
            
            document.getElementById('wordModal').style.display = 'flex';
        }

        function closeWordModal() {
            createParticle(event);
            document.getElementById('wordModal').style.display = 'none';
        }

        function triggerModalNow() {
            if (!currentUser) {
                alert('è¯·å…ˆç™»å½•ï¼');
                document.getElementById('loginPanel').style.display = 'flex';
                return;
            }
            
            createParticle(event);
            currentModalSentence = currentSentence;
            currentModalChinese = currentSentenceChinese;
            document.getElementById('inputArea').value = '';
            document.getElementById('chineseHint').style.display = 'none';
            document.getElementById('chineseHint').textContent = '';
            document.getElementById('modal').style.display = 'flex';
        }

        function toggleChineseHint() {
            createParticle(event);
            const hintElement = document.getElementById('chineseHint');
            if (hintElement.style.display === 'none' || hintElement.style.display === '') {
                hintElement.textContent = `ä¸­æ–‡ç¿»è¯‘ï¼š${currentModalChinese}`;
                hintElement.style.display = 'block';
            } else {
                hintElement.style.display = 'none';
            }
        }

        function closeModal() {
            createParticle(event);
            document.getElementById('modal').style.display = 'none';
        }

        async function checkAnswer() {
            if (!currentUser) return;
            
            createParticle(event);
            const userInput = document.getElementById('inputArea').value.trim().toLowerCase();
            const correctAnswer = currentModalSentence.trim().toLowerCase();
            const resultAlert = document.getElementById('resultAlert');
            const resultTitle = document.getElementById('resultTitle');
            const resultContent = document.getElementById('resultContent');

            if (userInput === correctAnswer) {
                // å›ç­”æ­£ç¡®
                dailyTaskCount++;
                
                // æ·»åŠ ç§¯åˆ†
                await addUserPoints(1);
                
                resultTitle.className = 'result-title result-correct';
                resultTitle.textContent = 'âœ… è®°å¿†å®Œå…¨æ­£ç¡®ï¼';
                resultContent.textContent = `åŸæ–‡ï¼š${currentModalSentence}\n\nâœ… è·å¾— +1 ç§¯åˆ†ï¼\nå·²å®Œæˆ ${dailyTaskCount}/${dailyTaskTarget} å¥\nå½“å‰ç§¯åˆ†: ${userPoints}`;
                
                // æ›´æ–°ä»»åŠ¡è¿›åº¦
                updateTaskProgress();
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆä»Šæ—¥ä»»åŠ¡
                if (dailyTaskCount >= dailyTaskTarget) {
                    // å®Œæˆæ¯æ—¥ä»»åŠ¡é¢å¤–å¥–åŠ±ç§¯åˆ†
                    await addUserPoints(5);
                    
                    // å¢åŠ åšæŒå¤©æ•°
                    const today = new Date().toLocaleDateString();
                    if (lastCheckinDate !== today) {
                        persistDays++;
                        lastCheckinDate = today;
                        localStorage.setItem('persistDays', persistDays);
                        
                        // è¿ç»­æ‰“å¡7å¤©é¢å¤–å¥–åŠ±
                        if (persistDays % 7 === 0) {
                            await addUserPoints(10);
                        }
                        
                        // æ›´æ–°ç”¨æˆ·èµ„æ–™
                        await updateUserProfile();
                    }
                    
                    // æ˜¾ç¤ºæ‰“å¡æˆåŠŸ
                    document.getElementById('checkinText').textContent = `ä½ å·²åšæŒå­¦ä¹  ${persistDays} å¤©ï¼Œè·å¾— +5 ç§¯åˆ†å¥–åŠ±ï¼\nå½“å‰æ€»ç§¯åˆ†: ${userPoints}`;
                    document.getElementById('checkinAlert').style.display = 'block';
                    
                    // é‡ç½®æ¯æ—¥è®¡æ•°
                    dailyTaskCount = 0;
                    localStorage.setItem('dailyTaskCount', 0);
                }
            } else {
                resultTitle.className = 'result-title result-error';
                resultTitle.textContent = 'âŒ è®°å¿†æœ‰é”™è¯¯å“¦ï¼';
                resultContent.textContent = `ä½ çš„è¾“å…¥ï¼š${userInput}\næ­£ç¡®åŸæ–‡ï¼š${currentModalSentence}`;
            }

            document.getElementById('modal').style.display = 'none';
            resultAlert.style.display = 'block';
            
            setTimeout(refreshSentence, 500);
        }

        function closeResultAlert() {
            createParticle(event);
            document.getElementById('resultAlert').style.display = 'none';
        }

        function updateTaskProgress() {
            const progressPercent = (dailyTaskCount / dailyTaskTarget) * 100;
            document.getElementById('progressFill').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `${dailyTaskCount}/${dailyTaskTarget}`;
            document.getElementById('guideBar').textContent = `ğŸ“– è¯·ç†Ÿè¯»å½“å‰å¥å­ï¼Œå·²å®Œæˆ ${dailyTaskCount}/${dailyTaskTarget} å¥ï¼Œå½“å‰ç§¯åˆ†: ${userPoints}`;
        }

        function updateTaskStats() {
            document.getElementById('taskStats').textContent = `å·²åšæŒ ${persistDays} å¤© | ç§¯åˆ†: ${userPoints}`;
        }

        function closeCheckinAlert() {
            createParticle(event);
            document.getElementById('checkinAlert').style.display = 'none';
            updateTaskProgress();
        }

        function showPointsModal() {
            createParticle(event);
            document.getElementById('pointsModal').style.display = 'flex';
        }

        function closePointsModal() {
            createParticle(event);
            document.getElementById('pointsModal').style.display = 'none';
        }

        // ========== ç²’å­ç‰¹æ•ˆï¼ˆä¿æŒä¸å˜ï¼‰==========
        function initParticleEffect() {
            document.addEventListener('click', function(e) {
                createParticle(e);
            });
        }

        function createParticle(e) {
            if (!e) return;
            
            const container = document.getElementById('particle-container');
            const particleCount = 15;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                const isCherry = Math.random() > 0.5;
                const size = Math.random() * 10 + 5;
                
                particle.style.position = 'absolute';
                particle.style.left = `${e.clientX}px`;
                particle.style.top = `${e.clientY}px`;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.borderRadius = isCherry ? '50% 0 50% 50%' : '50%';
                particle.style.backgroundColor = isCherry 
                    ? `rgba(${255}, ${Math.floor(Math.random()*50)+200}, ${Math.floor(Math.random()*50)+200}, ${Math.random()*0.8+0.2})`
                    : `rgba(${Math.floor(Math.random()*50)+200}, ${Math.floor(Math.random()*50)+200}, ${255}, ${Math.random()*0.8+0.2})`;
                particle.style.opacity = '0';
                particle.style.pointerEvents = 'none';
                particle.style.zIndex = '99999';
                particle.style.transform = 'translate(-50%, -50%)';
                
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 100 + 50;
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                
                const style = document.createElement('style');
                style.innerHTML = `
                    @keyframes particleFly {
                        0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                        50% { opacity: 0.8; transform: translate(${x}px, ${y}px) scale(0.8); }
                        100% { opacity: 0; transform: translate(${x*1.5}px, ${y*1.5}px) scale(0); }
                    }
                `;
                document.head.appendChild(style);
                
                particle.style.animation = `particleFly ${Math.random()*2+1}s ease forwards`;
                container.appendChild(particle);
                
                setTimeout(() => {
                    particle.remove();
                    style.remove();
                }, 3000);
            }
        }
    </script>
</body>
</html>
